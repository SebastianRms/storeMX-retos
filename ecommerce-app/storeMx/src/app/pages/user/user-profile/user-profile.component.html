<div class="max-w-7xl mx-auto p-4 md:p-8">
    
    <h1 class="text-3xl md:text-4xl font-extrabold text-gray-900 mb-8">
        Bienvenido, {{ userInfo.name || 'Usuario' }} ðŸ‘‹
    </h1>

    <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">

        <div class="lg:col-span-1 bg-white shadow-xl rounded-lg h-fit sticky top-4">
            
            <div class="p-6 text-center">
                <div class="w-24 h-24 mx-auto mb-4 bg-indigo-50 rounded-full flex items-center justify-center overflow-hidden border-4 border-indigo-200">
                    <span class="text-4xl text-indigo-600 font-bold">{{ (userInfo.name || 'U')[0] }}</span> 
                </div>

                <h2 class="text-xl font-bold text-gray-900 mb-1">{{ userInfo.name || 'Cargando Nombre...' }}</h2>
            </div>
            
            <hr class="border-gray-200">

            <nav class="p-4 space-y-1">
                <button (click)="setActiveTab('orders')" 
                        [class.bg-indigo-50]="activeTab === 'orders'"
                        [class.text-indigo-700]="activeTab === 'orders'"
                        class="w-full text-left flex items-center px-4 py-2 rounded-lg text-gray-600 hover:bg-indigo-50 hover:text-indigo-700 transition duration-150">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2h2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v2M7 7h10"></path></svg>
                    Historial de Pedidos
                </button>
                
                <button (click)="setActiveTab('forms')" 
                        [class.bg-indigo-50]="activeTab === 'forms'"
                        [class.text-indigo-700]="activeTab === 'forms'"
                        class="w-full text-left flex items-center px-4 py-2 rounded-lg text-gray-600 hover:bg-indigo-50 hover:text-indigo-700 transition duration-150">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                    Direcciones y Pago
                </button>
            </nav>
            
            <hr class="border-gray-200">
            
            <div class="p-4">
                 <button (click)="logout()" class="w-full bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded transition duration-150">
                     Cerrar SesiÃ³n
                 </button>
            </div>
            
        </div>
        
        <div class="lg:col-span-3 bg-white shadow-xl rounded-lg p-6">
            
            <div *ngIf="activeTab === 'forms'">
                <h2 class="text-2xl font-semibold text-indigo-600 mb-6 border-b pb-3">GestiÃ³n de Direcciones y Pago</h2>
                <app-user-forms></app-user-forms> 
            </div>
            
            <div *ngIf="activeTab === 'orders'">
                 <h2 class="text-2xl font-semibold text-indigo-600 mb-6 border-b pb-3">Historial de Pedidos</h2>
                 
                 <div *ngIf="ordersLoading" class="bg-gray-100 p-6 rounded-lg text-center text-gray-400 animate-pulse">
                     Cargando historial de pedidos...
                 </div>
                 
                 <div *ngIf="!ordersLoading && (userOrders$ | async) as orders">
                     <div *ngIf="orders.length === 0" class="bg-gray-100 p-6 rounded-lg text-center text-gray-500">
                         <p>AÃºn no tienes pedidos registrados.</p>
                     </div>
                     <div *ngFor="let order of orders" class="border p-3 rounded-lg mb-3 shadow-sm">
                         <p class="font-bold text-lg text-indigo-700">Orden #{{ order.orderNumber || order._id }}</p>
                         <p>Total: {{ order.total | currency:'USD':'symbol':'1.2-2' }}</p>
                         <p>Estado: <span class="badge bg-warning text-dark">{{ order.status }}</span></p>
                     </div>
                 </div>
            </div>
        </div>
    </div>
</div>